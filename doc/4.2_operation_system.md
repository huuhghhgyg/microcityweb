[< 4.1 SI Overview](4.1_si_overview.md) | [Table of Contents](readme.md) | [4.3 Scene and Object >](4.3_scene_and_object.md)

# 4.2 Operation System
This part of the functions is about controlling some basic features, some provided by the browser and others are derived from Lua debugging.

## Browser
The browser provides JavaScript running environment, storage and network communication features.

<a id='os.execute' class='anchor'> os.execute (javascript) </a>

Interface to the underlying JavaScript engine. This function will **await eval()** the given JavaScript and return the result as a string.

Dynamically executing javascript can greatly expand the functionality of MicroCity Web. Please note that the Lua engine runs in a web worker, so accessing the DOM requires executing the auxiliary function **RemoteCall**. Here is a simple example: 
```
os.execute("RemoteCall('alert', 'hello!')")
```
A more complex example is to create an application using python's fastapi and call it in MicroCity Web:
<br>1.&nbsp;First install fastapi: `pip install fastapi uvicorn`
<br>2.&nbsp;Then create main.py:

```
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
app = FastAPI()
app.add_middleware(
  CORSMiddleware,
  allow_origins=['\*'],
  allow_credentials=True,
  allow_methods=['\*'], 
  allow_headers=['\*'], 
)
@app.get("/msg")
async def read_msg():
  return {"msg": "Hello from FastAPI"}
```

3.&nbsp;Execute main.py: `uvicorn main:app --reload`
<br>4.&nbsp;Finally run the following script in MicroCity Web:

```
print(os.execute("(async () => (await (await fetch('http://127.0.0.1:8000/msg')).json()).msg)()"))
```
or
```
print(os.execute("fetch('http://127.0.0.1:8000/msg').then(res => res.json()).then(data => data.msg)"))
```

<a id='os.sleep' class='anchor'> os.sleep (ms) </a>

Sleep for ms milliseconds. 

<a id='os.getready' class='anchor'> os.getready () </a>

Suspend the execution if **Pause**![](../img/pause.svg) is clicked or return false if **Stop**![](../img/stop.svg) is clicked.

It is useful for controlling a long run script. User can pause it and run some commands in the console or stop it.

<a id='os.upload' class='anchor'> os.upload ([url]) </a>

Access the url file or prompt user choosing local files to upload to the virtual disk.

This function is used to facilitate the script accessing external files. User can upload files first, then start the program.

<a id='os.download' class='anchor'> os.download ([fpath]) </a>

Access the file or prompt user choosing files to download from the virtual disk.

## Debug
The Debug library retains the original functions of Lua and made modifications. Users can execute them in scripts or on the console.

<a id='debug.debug' class='anchor'> debug.debug ([b]) </a>

Enter debug mode (no parameters or b is true) or exit debug mode (b is false)

<a id='debug.pause' class='anchor'> debug.pause () </a>

Pause the execution in debug mode.

<a id='debug.cont' class='anchor'> debug.cont </a>

Continue the execution in debug mode.

<a id='debug.step' class='anchor'> debug.step </a>

Step over the execution in debug mode.

<a id='debug.stepi' class='anchor'> debug.stepi </a>

Step in the execution in debug mode.

<a id='debug.stepo' class='anchor'> debug.stepo </a>

Step out the execution in debug mode.

<a id='debug.watch' class='anchor'> debug.watch ([name])</a>

Add a variable with the name (string) to the watchlist or clear the watchlist (without name).

[< 4.1 SI Overview](4.1_si_overview.md) | [Table of Contents](readme.md) | [4.3 Scene and Object >](4.3_scene_and_object.md)